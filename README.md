# 课堂点名器/签到系统

一个功能完整的课堂点名器Web应用，支持CSV导入学生名单、随机点名（带3D地球动画效果）、迟到记录加权重、以及完整的签到记录管理和导出功能。

## 功能特性

### 核心功能
- **CSV导入名单** - 支持批量导入学生姓名
- **随机点名** - 点击按钮后3D地球旋转，随机选择学生
- **权重系统** - 迟到学生下次被点名概率提高2倍
- **记录管理** - 记录每次抽取、签到状态、备注信息
- **CSV导出** - 根据时间范围导出签到记录
- **3D地球动画** - 使用CSS动画实现模拟地球旋转效果

## 技术栈

- **前端**: HTML5 + CSS3 + Vanilla JavaScript
- **存储**: IndexedDB（支持大量数据存储和查询）
- **3D效果**: CSS3 动画 + 渐变（模拟地球效果）

## 文件结构

```
roll-caller/
├── index.html          # 主页面
├── css/
│   ├── main.css        # 主样式
│   └── earth.css       # 3D地球动画样式
├── js/
│   ├── main.js         # 主逻辑
│   ├── storage.js      # IndexedDB存储层
│   ├── import.js       # CSV导入功能
│   ├── export.js       # CSV导出功能
│   └── earth.js        # 3D地球动画逻辑
└── README.md           # 本文件
```

## 使用方法

### 1. 启动应用

直接用浏览器打开 `index.html` 文件，或者使用本地服务器：

```bash
# 使用Python启动简单HTTP服务器
python -m http.server 8000

# 或使用Node.js的http-server
npx http-server
```

然后在浏览器中访问 `http://localhost:8000`

### 2. 导入学生名单

点击"导入名单"按钮，选择CSV文件。CSV格式示例：

```csv
姓名
张三
李四
王五
```

或使用多列格式（第二列为姓名）：

```csv
ID,姓名,班级
1,张三,一班
2,李四,二班
3,王五,一班
```

### 3. 开始点名

1. 点击"开始点名"按钮
2. 3D地球会开始旋转
3. 2秒后随机选中一名学生
4. 选择签到状态（出席/迟到/缺席）
5. 可选填写备注信息
6. 点击"确认记录"保存

### 4. 查看和管理记录

- 在"签到记录"区域查看所有记录
- 使用日期筛选功能查找特定时间段的记录
- 点击"导出筛选结果"导出CSV文件

### 5. 学生管理

- 在"学生名单"区域查看所有学生
- 可以看到每个学生的当前权重
- 点击"重置权重"将学生权重恢复为1
- 点击"删除"移除学生

## 权重系统说明

- 默认权重：1
- 迟到后权重：2（被点名概率提高2倍）
- 出席后权重：重置为1
- 权重越高，被随机选中的概率越大

## 数据存储

应用使用IndexedDB存储数据，数据存储在浏览器本地：

- `students` 表：存储学生信息
- `records` 表：存储签到记录

数据会持久保存，清除浏览器数据会删除所有记录。

## 导出格式

导出的CSV文件包含以下字段：

- 时间
- 学生姓名
- 类型
- 状态（present/late/absent）
- 备注

## 浏览器兼容性

- Chrome/Edge：✅ 完全支持
- Firefox：✅ 完全支持
- Safari：✅ 完全支持

## 开发说明

### 修改权重倍数

在 `js/main.js` 中找到 `confirmAttendance` 方法，修改：

```javascript
// 如果是迟到，增加权重
if (status === 'late') {
    await storage.updateStudentWeight(this.currentStudent.id, 2); // 修改这里的数字
}
```

### 调整动画时长

在 `js/main.js` 中找到 `startDraw` 方法，修改：

```javascript
// 2秒后停止并选择学生
setTimeout(async () => {
    // ...
}, 2000); // 修改这里的毫秒数
```

### 自定义样式

- 修改 `css/main.css` 调整整体样式
- 修改 `css/earth.css` 调整地球动画效果

## 许可证

MIT License
